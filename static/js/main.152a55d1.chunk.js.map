{"version":3,"sources":["utils/gapi.js","components/Playlists.js","components/Videos.js","components/Channels.js","utils/sorting.js","components/TwinVideos.js","components/Subscriptions.js","App.js","registerServiceWorker.js","index.js"],"names":["buildApiRequest","requestMethod","path","params","properties","undefined","window","gapi","client","console","log","request","p","hasOwnProperty","removeEmptyParams","resource","normalizedProps","value","substr","adjustedName","replace","split","propArray","ref","pa","length","key","createResource","body","method","buildPlaylistsRequest","pageToken","mine","part","maxResults","buildPlaylistItemsRequest","playlistId","executeRequest","callback","callbackError","then","response","result","catch","reason","copyMultipleIntoPlaylist","playlistItemIds","videoIds","moveToPlaylistId","progressCallback","successCallback","failureCallback","insertRequests","i","push","snippet.playlistId","snippet.resourceId.kind","snippet.resourceId.videoId","sequence","Promise","resolve","_loop","videoId","concat","playlistItemId","error","moveMultipleIntoPlaylist","deleteRequests","id","_loop2","t","removeMultipleFromPlaylist","_loop3","r","Playlists","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","newPlaylistName","event","setState","newPlaylist","target","createPlaylist","state","onBehalfOfContentOwner","snippet.title","snippet.description","snippet.tags[]","snippet.defaultLanguage","status.privacyStatus","resp","retrieve","createError","store","data","list","items","sort","a","b","snippet","title","toLowerCase","playlists","nextPageToken","updateFilter","keyCode","filter","refresh","isAuthorized","prevProps","prevState","_this$state","react_default","createElement","onClick","type","onChange","className","onKeyUp","indexOf","map","playlist","index","Link","to","contentDetails","itemCount","Component","Videos","storePlaylists","storeVideos","currentToken","videos","toConsumableArray","retrieveVideos","updatePlaylistName","playlistName","retrievePlaylistName","req","e","TypeError","warn","assertThisInitialized","videosLoading","retrievePlaylists","removeFromPlaylistState","videoItemId","findIndex","splice","removeError","code","message","remove","insertError","move","insertRequest","deleteRequest","movep","moveSuccess","_ref","operation","moveFailure","moveVisible","videoItemIds","video","includes","setMoveToList","f","clearFilter","arguments","match","playlistid","_this2","visibleVideos","defaultValue","href","rel","Channels","channels","relatedPlaylists","keys","name","snippetTitleSort","snippetPublishedAtSort","d1","Date","parse","publishedAt","d2","snippetPositionSort","position","contentDetailsPublishedAtSort","snippetTitleSortReverse","snippetPublishedAtSortReverse","snippetPositionSortReverse","contentDetailsPublishedAtSortReverse","SORT_BY_SNIPPET_TITLE","SORT_BY_SNIPPET_PUBLISHED_AT","SORT_BY_SNIPPET_POSITION","SORT_BY_VIDEO_PUBLISHED_AT","SORT_ASCENDING","TwinVideos","setSortMethod","listIndex","produce","draft","lists","sortMethod","sortDirection","getSortFunction","asc","errorMessage","refreshPlaylists","refreshPlaylist","setPlaylist","k","getVisibleIds","playlistItem","forEach","mark","marked","Array","isArray","clearMarked","progress","failure","copy","sourceListIndex","targetListIndex","copyAll","_this$getVisibleIds","moveAll","_this$getVisibleIds2","removeAll","_this$getVisibleIds3","sync","dismissErrorMessage","toggleSync","filt","react","m","Subscriptions","subscriptions","storeChannelPlaylist","channelId","subscriptionsPlaylists","retrieveChannelPlaylists","buildChannelPlaylistsRequest","description","subscription","chanId","resourceId","item","App","google_api","user","setSigninStatus","currentUser","get","hasGrantedScopes","updateSigninStatus","initClient","init","clientId","discoveryDocs","scope","inst","auth2","getAuthInstance","isSignedIn","listen","authorize","grantOfflineAccess","signIn","getBasicProfile","userProfile","grantAccess","prompt","load","BrowserRouter","getName","Switch","Route","render","src_components_Channels","assign","src_components_Subscriptions","src_components_Playlists","src_components_Videos","components_TwinVideos","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","noop","ReactDOM","src_App_0","document","getElementById","URL","process","origin","addEventListener","fetch","status","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.152a55d1.chunk.js","sourcesContent":["export function createResource(properties) {\n    // console.log(\"createResource\");\n    let resource = {};\n    let normalizedProps = properties;\n    for (let p in properties) {\n        let value = properties[p];\n        if (p && p.substr(-2, 2) === '[]') {\n            let adjustedName = p.replace('[]', '');\n            if (value) {\n                normalizedProps[adjustedName] = value.split(',');\n            }\n            delete normalizedProps[p];\n        }\n    }\n    for (let p in normalizedProps) {\n        // Leave properties that don't have values out of inserted resource.\n        if (normalizedProps.hasOwnProperty(p) && normalizedProps[p]) {\n            let propArray = p.split('.');\n            let ref = resource;\n            for (let pa = 0; pa < propArray.length; pa++) {\n                let key = propArray[pa];\n                if (pa === propArray.length - 1) {\n                    ref[key] = normalizedProps[p];\n                } else {\n                    ref = ref[key] = ref[key] || {};\n                }\n            }\n        }\n    }\n    return resource;\n}\n\nexport function removeEmptyParams(params) {\n    // console.log(\"removeEmptyParams\");\n    for (let p in params) {\n        if (\n            params.hasOwnProperty(p) &&\n            (!params[p] || params[p] === 'undefined')\n        ) {\n            delete params[p];\n        }\n    }\n    return params;\n}\n\nexport function buildApiRequest(requestMethod, path, params, properties) {\n    // console.log(\"buildApiRequest\", requestMethod, path, params, properties);\n\n    if (window.gapi.client === undefined || window.gapi.client === null) {\n        console.log('buildApiRequest window.gapi.client is undefined or null');\n        return null;\n    }\n\n    params = removeEmptyParams(params);\n\n    // console.log(\"buildApiRequest params\", params);\n\n    let request;\n    if (properties) {\n        let resource = createResource(properties);\n        console.log('buildApiRequest resource', resource);\n        request = window.gapi.client.request({\n            body: resource,\n            method: requestMethod,\n            path: path,\n            params: params,\n        });\n    } else {\n        request = window.gapi.client.request({\n            method: requestMethod,\n            path: path,\n            params: params,\n        });\n    }\n    return request;\n}\n\nexport function buildPlaylistNameRequest(id) {\n    return buildApiRequest('GET', '/youtube/v3/playlists', {\n        id: id,\n        part: 'snippet,contentDetails'\n    });\n}\n\nexport function buildPlaylistsRequest(pageToken) {\n    return buildApiRequest('GET', '/youtube/v3/playlists', {\n        mine: 'true',\n        part: 'snippet,contentDetails',\n        maxResults: '50',\n        pageToken: pageToken\n    });\n}\n\nexport function buildChannelPlaylistsRequest(channelId, pageToken) {\n    return buildApiRequest('GET', '/youtube/v3/playlists', {\n        channelId: channelId,\n        part: 'snippet,contentDetails',\n        maxResults: '50',\n        pageToken: pageToken\n    });\n}\n\nexport function buildPlaylistItemsRequest(playlistId, pageToken) {\n    return buildApiRequest('GET', '/youtube/v3/playlistItems', {\n        maxResults: '50',\n        part: 'snippet,contentDetails',\n        playlistId: playlistId,\n        pageToken: pageToken\n    });\n}\n\nexport function buildChannelsRequest() {\n    return buildApiRequest('GET', '/youtube/v3/channels', {\n        mine: 'true',\n        part: 'contentDetails'\n    });\n}\n\n\n\nexport function buildSubscriptionsRequest(pageToken) {\n    return buildApiRequest('GET', '/youtube/v3/subscriptions', {\n        mine: 'true',\n        part: 'snippet,contentDetails',\n        maxResults: 50,\n        pageToken: pageToken\n    });\n}\n\n\n/*\nexport function insertInPlaylist(videoId, moveToPlaylistId) {\n    let insertRequest = buildApiRequest(\n        'POST',\n        '/youtube/v3/playlistItems',\n        {\n            part: 'snippet'\n        },\n        {\n            'snippet.playlistId': moveToPlaylistId,\n            'snippet.resourceId.kind': 'youtube#video',\n            'snippet.resourceId.videoId': videoId\n        }\n    );\n\n    return new Promise(function(resolve, reject) {\n        insertRequest\n            .then(function(response) {\n                resolve(response.result);\n            })\n            .catch(function() {\n                reject();\n            });\n    });\n}\n*/\n\nexport function executeRequest(request, callback, callbackError) {\n\n    if (request === undefined || request === null) {\n        console.log('executeRequest request is undefined or null');\n        return;\n    }\n\n    // https://developers.google.com/api-client-library/javascript/reference/referencedocs#gapiclientbatch\n    // https://developers.google.com/api-client-library/javascript/features/promises\n    // gapi.client.Request.then(onFulfilled, onRejected, context)\n\n    request.then(\n        // onFulfilled handler:\n        function(response) {\n            // response:\n            //     An object containing information about the HTTP response.\n            //     Name\t        Type\t            Description\n            //     result\t    *\t                The JSON-parsed result. false if not JSON-parseable.\n            //     body\t        string\t            The raw response string.\n            //     headers\t    object | undefined\tThe map of HTTP response headers.\n            //     status\t    number | undefined\tHTTP status.\n            //     statusText\tstring | undefined\tHTTP status text.\n            if (callback) callback(response.result);\n        }\n    ).catch(\n        (reason) => {\n            if (callbackError) callbackError(reason);\n        }\n    );\n}\n\nexport function copyMultipleIntoPlaylist(\n    playlistItemIds,\n    videoIds,\n    moveToPlaylistId,\n    progressCallback,\n    successCallback,\n    failureCallback) {\n\n    console.log('copyMultipleIntoPlaylist', playlistItemIds, videoIds, moveToPlaylistId);\n\n    if (!moveToPlaylistId) return;\n\n    let insertRequests = [];\n    for (let i = 0; i < videoIds.length; i++) {\n        insertRequests.push(\n            buildApiRequest(\n                'POST',\n                '/youtube/v3/playlistItems',\n                {\n                    part: 'snippet',\n                },\n                {\n                    'snippet.playlistId': moveToPlaylistId,\n                    'snippet.resourceId.kind': 'youtube#video',\n                    'snippet.resourceId.videoId': videoIds[i],\n                }\n            )\n        );\n    }\n\n    // Start off with a promise that always resolves\n    let sequence = Promise.resolve();\n\n    for (let i = 0; i < insertRequests.length; i++) {\n        sequence = sequence\n            .then(() => insertRequests[i])\n            .then(() => {\n                if (progressCallback) {\n                    progressCallback({videoId: `${videoIds[i]}`, playlistItemId: `${playlistItemIds[i]}`});\n                }\n            });\n    }\n\n    sequence\n        .then(() => {\n            console.log(\"copyMultipleIntoPlaylist: success\");\n            if (successCallback) {\n                successCallback();\n            }\n        })\n        .catch(function(reason) {\n            console.log(\"copyMultipleIntoPlaylist: failure\", reason);\n            if (failureCallback) {\n                failureCallback({\n                    error: reason.result.error //,\n                    // videoId: `${videoIds[i]}`,\n                    // playlistItemId: `${playlistItemIds[i]}`,\n                })\n            }\n        });\n\n}\n\nexport function moveMultipleIntoPlaylist(\n    playlistItemIds,\n    videoIds,\n    moveToPlaylistId,\n    progressCallback,\n    successCallback,\n    failureCallback) {\n\n    // console.log('moveMultipleIntoPlaylist', playlistItemIds, videoIds, moveToPlaylistId);\n\n    if (!moveToPlaylistId) return;\n\n    let insertRequests = [];\n    for (let i = 0; i < videoIds.length; i++) {\n        insertRequests.push(\n            buildApiRequest(\n                'POST',\n                '/youtube/v3/playlistItems',\n                {\n                    part: 'snippet',\n                },\n                {\n                    'snippet.playlistId': moveToPlaylistId,\n                    'snippet.resourceId.kind': 'youtube#video',\n                    'snippet.resourceId.videoId': videoIds[i],\n                }\n            )\n        );\n    }\n\n    let deleteRequests = [];\n    for (let i = 0; i < playlistItemIds.length; i++) {\n        deleteRequests.push(\n            buildApiRequest('DELETE', '/youtube/v3/playlistItems', {\n                id: playlistItemIds[i],\n            })\n        );\n    }\n\n    // Start off with a promise that always resolves\n    let sequence = Promise.resolve();\n\n    for (let i = 0; i < insertRequests.length; i++) {\n        sequence = sequence\n            .then(() => insertRequests[i])\n            .then(() => deleteRequests[i])\n            .then(() => {\n                if (progressCallback) {\n                    progressCallback({videoId: `${videoIds[i]}`, playlistItemId: `${playlistItemIds[i]}`});\n                }\n            });\n    }\n\n    sequence\n        .then(t => {\n            console.log(\"moveMultipleIntoPlaylist: call insertSuccessCallback\");\n            successCallback();\n        })\n        .catch(function(reason) {\n            console.log(\"move failure\", reason);\n            if (failureCallback) {\n                failureCallback({\n                    error: reason.result.error //,\n                    // videoId: `${videoIds[i]}`,\n                    // playlistItemId: `${playlistItemIds[i]}`,\n                })\n            }\n        });\n\n}\n\nexport function removeMultipleFromPlaylist(\n    playlistItemIds,\n    videoIds,\n    playlistId,\n    progressCallback,\n    successCallback,\n    failureCallback) {\n\n    console.log('removeMultipleFromPlaylist', playlistItemIds, videoIds, playlistId);\n\n    if (!playlistId) return;\n\n    let deleteRequests = [];\n    for (let i = 0; i < playlistItemIds.length; i++) {\n        deleteRequests.push(\n            buildApiRequest(\n                'DELETE',\n                '/youtube/v3/playlistItems',\n                {\n                    id: playlistItemIds[i],\n                }\n            )\n        );\n    }\n\n    let sequence = Promise.resolve();\n    for (let i = 0; i < deleteRequests.length; i++) {\n        sequence = sequence\n            .then(() => deleteRequests[i])\n            .then(() => {\n                if (progressCallback) {\n                    progressCallback({videoId: `${videoIds[i]}`, playlistItemId: `${playlistItemIds[i]}`});\n                }\n            });\n    }\n\n    sequence\n        .then(r => {\n            successCallback();\n        })\n        .catch(function(reason) {\n            console.log(\"remove failure\", reason);\n            if (failureCallback) {\n                failureCallback({\n                    error: reason.result.error //,\n                    // videoId: `${videoIds[i]}`,\n                    // playlistItemId: `${playlistItemIds[i]}`,\n                })\n            }\n        });\n\n}\n","import React, { Component } from 'react';\nimport {\n    buildApiRequest,\n    buildPlaylistsRequest,\n    executeRequest,\n} from '../utils/gapi';\nimport { Link } from 'react-router-dom';\nimport './Playlists.css';\n\n/**\n * Display the list of playlists of the authorized user.\n */\nclass Playlists extends Component {\n\n    constructor(props) {\n        super(props);\n        console.log('Playlists.constructor', props);\n        this.state = {\n            isAuthorized: false,\n            playlists: null,\n            newPlaylist: '',\n            filter: '',\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        console.log('Playlists.getDerivedStateFromProps', props);\n        if (props.isAuthorized !== state.isAuthorized) {\n            return {\n                isAuthorized: props.isAuthorized,\n            };\n        }\n\n        // No state update necessary\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        console.log('Playlists.componentDidUpdate');\n        // At this point, we're in the \"commit\" phase, so it's safe to load the new data.\n        if (this.state.isAuthorized && this.state.playlists === null) {\n            // !!! only retrieve data if state.playlists is empty; otherwise this will generate an endless loop.\n            this.retrieve();\n        }\n    }\n\n    newPlaylistName = event => {\n        console.log('Playlists.newPlaylistName');\n        this.setState({ newPlaylist: event.target.value });\n    };\n\n    createPlaylist = () => {\n        if (!this.state.newPlaylist) return;\n        let request = buildApiRequest(\n            'POST',\n            '/youtube/v3/playlists',\n            {\n                part: 'snippet,status',\n                onBehalfOfContentOwner: '',\n            },\n            {\n                'snippet.title': this.state.newPlaylist,\n                'snippet.description': '',\n                'snippet.tags[]': '',\n                'snippet.defaultLanguage': '',\n                'status.privacyStatus': 'private', // unlisted, private, public    https://developers.google.com/youtube/v3/docs/playlists#resource\n            }\n        );\n        //executeRequest(request, () => { this.insertSuccess(videoItemId) }, this.insertError);\n        executeRequest(\n            request,\n            resp => {\n                console.log('created playlist', resp);\n                this.retrieve();\n            },\n            this.createError\n        );\n    };\n\n    store = data => {\n        console.log('Playlists.store');\n        if (!data) return;\n        let list = data.items;\n        list.sort(function(a, b) {\n            return a.snippet.title.toLowerCase() > b.snippet.title.toLowerCase()\n                ? 1\n                : b.snippet.title.toLowerCase() > a.snippet.title.toLowerCase()\n                ? -1\n                : 0;\n        });\n        this.setState({ playlists: list });\n    };\n\n    retrieve = nextPageToken => {\n        console.log('Playlists.retrieve', nextPageToken);\n        executeRequest(buildPlaylistsRequest(nextPageToken), this.store);\n    };\n\n    updateFilter = event => {\n        console.log('Playlists.updateFilter');\n        if (event.keyCode === 27) {\n            this.setState({ filter: '' });\n        } else {\n            this.setState({ filter: event.target.value });\n        }\n    };\n\n    refresh = () => {\n        this.retrieve();\n    };\n\n    componentDidMount() {\n        console.log('Playlists.componentDidMount');\n        this.retrieve();\n    }\n\n    /*\n{\n   \"kind\":\"youtube#playlist\",\n   \"etag\":\"\\\"DuHzAJ-eQIiCIp7p4ldoVcVAOeY/0v8-koTMYYwrjjH091gV-uVnD7w\\\"\",\n   \"id\":\"PL_x8MpUypxebPqAdp-FT7MeViRdJyVlwR\",\n   \"snippet\":{\n      \"publishedAt\":\"2015-10-04T21:36:35.000Z\",\n      \"channelId\":\"UCE0q36_agQAeb4G3PXivkew\",\n      \"title\":\"trailers\",\n      \"description\":\"\",\n      \"thumbnails\":{\n         \"default\":{\n            \"url\":\"https://i.ytimg.com/vi/z5gxjvYDPJQ/default.jpg\",\n            \"width\":120,\n            \"height\":90\n         },\n         \"medium\":{\n            \"url\":\"https://i.ytimg.com/vi/z5gxjvYDPJQ/mqdefault.jpg\",\n            \"width\":320,\n            \"height\":180\n         },\n         \"high\":{\n            \"url\":\"https://i.ytimg.com/vi/z5gxjvYDPJQ/hqdefault.jpg\",\n            \"width\":480,\n            \"height\":360\n         }\n      },\n      \"channelTitle\":\"François Georgy\",\n      \"localized\":{\n         \"title\":\"trailers\",\n         \"description\":\"\"\n      }\n   },\n   \"contentDetails\":{\n      \"itemCount\":3\n   }\n}\n    */\n\n    render() {\n        const { isAuthorized, playlists, newPlaylist, filter } = this.state;\n\n        console.log('Playlists render');\n\n        if (!isAuthorized) {\n            return <div />;\n        } else {\n            if (playlists) {\n                return (\n                    <div>\n                        <h2>list of playlists</h2>\n                        <button onClick={this.refresh}>refresh</button>\n                        <div>\n                            new playlist:{' '}\n                            <input\n                                type=\"text\"\n                                value={newPlaylist}\n                                onChange={this.newPlaylistName}\n                            />{' '}\n                            <button onClick={this.createPlaylist}>\n                                create\n                            </button>\n                        </div>\n                        <div className=\"filter\">\n                            filter:{' '}\n                            <input type=\"text\" onKeyUp={this.updateFilter} />\n                        </div>\n                        <div>\n                            {playlists\n                                .filter(\n                                    p =>\n                                        p.snippet.title\n                                            .toLowerCase()\n                                            .indexOf(filter.toLowerCase()) > -1\n                                )\n                                .map((playlist, index) => {\n                                    // console.log(JSON.stringify(playlist));\n                                    return (\n                                        <div key={index}>\n                                            <Link to={`/videos/${playlist.id}`}>\n                                                {playlist.snippet.title} (\n                                                {\n                                                    playlist.contentDetails\n                                                        .itemCount\n                                                }{' '}\n                                                videos)\n                                            </Link>\n                                        </div>\n                                    );\n                                    // return <div key={index}><a href={`#${playlist.id}`}>{playlist.snippet.title}</a> ({playlist.contentDetails.itemCount} videos)</div>\n                                })}\n                        </div>\n                    </div>\n                );\n            } else {\n                return <div>Retrieving the playlists...</div>;\n            }\n        }\n    }\n}\n\nexport default Playlists;\n","import React, { Component } from 'react';\nimport {\n    buildApiRequest,\n    buildPlaylistsRequest,\n    buildPlaylistItemsRequest,\n    executeRequest,\n    buildPlaylistNameRequest,\n    moveIntoPlaylist,\n    moveMultipleIntoPlaylist,\n} from '../utils/gapi';\nimport './Videos.css';\n\n/**\n * Display the list of videos for a playlist.\n */\nclass Videos extends Component {\n\n    constructor(props) {\n        super(props);\n        // console.log(\"Videos.constructor\", props);\n        this.state = {\n            isAuthorized: false,\n            playlistName: null,\n            playlistId: props.match.params.playlistid,\n            videos: null,\n            playlists: null,\n            moveToPlaylistId: null,\n            filter: '',\n            videosLoading: false,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        // console.log(\"Videos.getDerivedStateFromProps\", props);\n        if (props.isAuthorized !== state.isAuthorized) {\n            return {\n                isAuthorized: props.isAuthorized,\n            };\n        }\n        // No state update necessary\n        return null;\n    }\n\n    componentDidMount() {\n        // console.log('Videos.componentDidMount');\n        this.refresh();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(`Videos.componentDidUpdate, playlistId=${this.state.playlistId}, prev=${prevState.playlistId}`, this.state);\n\n        if (!this.state.isAuthorized) return;\n\n        // At this point, we're in the \"commit\" phase, so it's safe to load the new data.\n        // if (this.state.isAuthorized && this.state.playlistId && ((this.state.videos === null) || (this.state.videos.length === 0))) {\n\n        if (this.state.playlistName === null) {\n            // !!! only retrieve data if state.playlistName is empty; otherwise this will generate an endless loop.\n            console.log('Videos.componentDidUpdate: call retrievePlaylistName');\n            this.retrievePlaylistName();\n        }\n\n        if (\n            !this.state.videosLoading &&\n            this.state.playlistId &&\n            this.state.videos === null\n        ) {\n            // !!! only retrieve data if state.videos is empty; otherwise this will generate an endless loop.\n            console.log('Videos.componentDidUpdate: call retrieveVideos');\n            this.retrieveVideos();\n        }\n\n        if (this.state.playlists === null) {\n            // !!! only retrieve data if state.playlists is empty; otherwise this will generate an endless loop.\n            console.log('Videos.componentDidUpdate: call retrievePlaylists');\n            this.retrievePlaylists();\n        }\n    }\n\n    storePlaylists = data => {\n        // console.log(\"Videos.storePlayLists\", data.items);\n        if (!data) return;\n        let list = data.items;\n        list.sort(function(a, b) {\n            return a.snippet.title.toLowerCase() > b.snippet.title.toLowerCase()\n                ? 1\n                : b.snippet.title.toLowerCase() > a.snippet.title.toLowerCase()\n                ? -1\n                : 0;\n        });\n        this.setState({ playlists: list });\n    };\n\n    storeVideos = (data, currentToken) => {\n        // console.log('Videos.storeVideos', currentToken);\n\n        if (!data) return;\n\n        // console.log(\"Videos.storeVideos\", data);\n\n        let list = data.items;\n        list.sort(function(a, b) {\n            return a.snippet.title.toLowerCase() > b.snippet.title.toLowerCase()\n                ? 1\n                : b.snippet.title.toLowerCase() > a.snippet.title.toLowerCase()\n                ? -1\n                : 0;\n        });\n\n        if (currentToken === undefined || !currentToken) {\n            this.setState({ videos: list });\n        } else {\n            this.setState(prevState => ({ videos: [...prevState.videos, ...list] }));\n        }\n\n        if (data.nextPageToken) {\n            this.retrieveVideos(data.nextPageToken);\n        }\n    };\n\n    updatePlaylistName = playlistName => {\n        this.setState({ playlistName });\n    };\n\n    retrievePlaylistName = () => {\n        if (!this.state.playlistId) {\n            console.warn('state.playlistId is empty');\n            return;\n        }\n\n        let req = buildPlaylistNameRequest(this.state.playlistId);\n\n        if (!req) {\n            console.warn('req is null');\n            return;\n        }\n\n        req.then(\n            function(response) {\n                try {\n                    this.updatePlaylistName(\n                        response.result.items[0].snippet.title\n                    );\n                } catch (e) {\n                    if (e instanceof TypeError) {\n                        console.log('buildPlaylistNameRequest incomplete response', e);\n                    } else {\n                        console.error('buildPlaylistNameRequest unexpected error', e);\n                    }\n                }\n            },\n            function() {\n                // onRejected handler\n                console.warn('buildPlaylistNameRequest rejected');\n            },\n            this\n        );\n    };\n\n    retrieveVideos = nextPageToken => {\n        // console.log(`Videos.retrieveVideos, playlistId=${this.state.playlistId}, pageToken=${nextPageToken}`);\n        // console.log(`Videos.retrieveVideos set videosLoading=true`);\n        this.setState({ videosLoading: true });\n        executeRequest(\n            buildPlaylistItemsRequest(this.state.playlistId, nextPageToken),\n            data => this.storeVideos(data, nextPageToken)\n        );\n    };\n\n    retrievePlaylists = () => {\n        // console.log(\"Videos.retrievePlayLists\");\n        executeRequest(buildPlaylistsRequest(), this.storePlaylists);\n    };\n\n    removeFromPlaylistState = videoItemId => {\n        // console.log(\"Videos.removeFromPlaylistState\", videoItemId);\n        let videos = this.state.videos;\n        let i = videos.findIndex(function f(e) {\n            return e.id === videoItemId;\n        });\n        // console.log(\"Videos.removeSuccess: video to delete: \", i, videos[i]);\n        videos.splice(i, 1);\n        this.setState({ videos });\n    };\n\n    removeError = error => {\n        console.log('Videos.removeError', error.code, error.message);\n    };\n\n    /**\n     * Remove a video from the current playlist\n     * @param videoItemId ID of the video-item in the current playlist\n     */\n    remove = videoItemId => {\n        // console.log('Videos.remove', videoItemId);\n        if (!videoItemId) return;\n        let request = buildApiRequest('DELETE', '/youtube/v3/playlistItems', {\n            id: videoItemId,\n        });\n        executeRequest(\n            request,\n            () => this.removeFromPlaylistState(videoItemId),\n            this.removeError\n        );\n    };\n\n    createError = error => {\n        console.log('Videos.insertError', error);\n    };\n\n    insertError = error => {\n        console.log('Videos.insertError', error);\n    };\n\n    /**\n     * Move the video to another playlist. The video will be removed from the current playlist.\n     * @param videoItemId ID of the video-item in the current playlist\n     * @param videoId ID of the video\n     */\n    move = (videoItemId, videoId, moveToPlaylistId) => {\n        // console.log('Videos.move', videoItemId, videoId, moveToPlaylistId);\n\n        if (!moveToPlaylistId) return;\n\n        let insertRequest = buildApiRequest(\n            'POST',\n            '/youtube/v3/playlistItems',\n            {\n                part: 'snippet', //,\n                // 'onBehalfOfContentOwner': ''\n            },\n            {\n                'snippet.playlistId': moveToPlaylistId,\n                'snippet.resourceId.kind': 'youtube#video',\n                'snippet.resourceId.videoId': videoId, //,\n                // 'snippet.position': ''\n            }\n        );\n\n        let deleteRequest = buildApiRequest(\n            'DELETE',\n            '/youtube/v3/playlistItems',\n            {\n                id: videoItemId,\n            }\n        );\n\n        //executeRequest(request, () => { this.insertSuccess(videoItemId) }, this.insertError);\n        // executeRequest(request, () => { this.remove(videoItemId) }, this.insertError);\n\n        // https://developers.google.com/api-client-library/javascript/reference/referencedocs#gapiclientbatch\n        // https://developers.google.com/api-client-library/javascript/features/promises\n        // gapi.client.Request.then(onFulfilled, onRejected, context)\n\n        // response:\n        //     An object containing information about the HTTP response.\n        //     Name\t        Type\t            Description\n        //     result\t    *\t                The JSON-parsed result. false if not JSON-parseable.\n        //     body\t        string\t            The raw response string.\n        //     headers\t    object | undefined\tThe map of HTTP response headers.\n        //     status\t    number | undefined\tHTTP status.\n        //     statusText\tstring | undefined\tHTTP status text.\n\n        /*\n        insertRequest\n            .then(function(response) {    // onFulfilled handler:\n                console.log(\"insertRequest promise onFulfilled handler\", response);\n                return deleteRequest\n                //},\n                // // onRejected handler:\n                // function () {\n                //     console.log(\"insertRequest onRejected handler\");\n                // },\n                // // context:\n                // this\n            }\n            // , function(reason) {\n            //     console.log(\"insertRequest promise onRejected handler\", reason);\n            // }\n            )\n            .catch(function(error) {\n                console.log(\"insert failed\", error);\n                throw error;    // let the error flow through the full chain.\n            })\n            .then(function(response) {\n                console.log(\"deleteRequest promise onFulfilled handler\", response);\n            }, function(reason) {\n                console.log(\"deleteRequest promise onRejected handler\", reason);\n            })\n            .catch(function(error) {\n                console.log(\"delete failed\", error);\n            });\n*/\n        let r = null;\n\n        // console.log('calling insertRequest');\n        insertRequest\n            .then(function() {\n                // console.log('calling deleteRequest');\n                return deleteRequest.then(function() {\n                    // console.log('deleteRequest.then');\n                    r = 'OK';\n                });\n            })\n            .catch(function(reason) {\n                // console.log('move failed', JSON.stringify(reason));\n                r = reason.result\n                    ? reason.result.error.message\n                    : 'unknow reason';\n            });\n\n        return r;\n\n        // {\n        //  \"result\":{\n        //      \"error\":{\n        //          \"errors\":[\n        //              {\"domain\":\"youtube.playlistItem\",\"reason\":\"playlistIdRequired\",\n        //              \"message\":\"Playlist id not specified.\"}],\n        //          \"code\":400,\n        //          \"message\":\"Playlist id not specified.\"}},\n        //          \"body\":\"{\\n \\\"error\\\": {\\n  \\\"errors\\\": [\\n   {\\n    \\\"domain\\\": \\\"youtube.playlistItem\\\",\\n    \\\"reason\\\": \\\"playlistIdRequired\\\",\\n    \\\"message\\\": \\\"Playlist id not specified.\\\"\\n   }\\n  ],\\n  \\\"code\\\": 400,\\n  \\\"message\\\": \\\"Playlist id not specified.\\\"\\n }\\n}\\n\",\n        //          \"headers\":{\"date\":\"Thu, 17 Jan 2019 13:26:34 GMT\",\"content-encoding\":\"gzip\",\"server\":\"GSE\",\"content-type\":\"application/json; charset=UTF-8\",\"vary\":\"Origin, X-Origin\",\"cache-control\":\"private, max-age=0\",\"content-length\":\"150\",\"expires\":\"Thu, 17 Jan 2019 13:26:34 GMT\"},\n        //          \"status\":400,\n        //          \"statusText\":null}\n    };\n\n    movep = (videoItemId, videoId, moveToPlaylistId) => {\n        // console.log('movep', videoItemId, videoId, moveToPlaylistId);\n        // insertInPlaylist(videoId, moveToPlaylistId)\n        //     .then(function(response) {\n        //         console.log(\"movep.insertInPlaylist resovled\", response);\n        //     })\n        //     .catch(function(error) {\n        //         console.log(\"movep.insertInPlaylist rejected\");\n        //     });\n\n        // let r = moveIntoPlaylist(videoItemId, videoId, moveToPlaylistId);\n        // console.log(\"movep, r\", r);\n\n/*\n        moveIntoPlaylist(videoItemId, videoId, moveToPlaylistId)\n            .then(function(response) {\n                console.log('movep.moveIntoPlaylist resolved', response);\n            })\n            .catch(function(reason) {\n                console.log(\n                    'movep.moveIntoPlaylist rejected',\n                    reason,\n                    reason.result.error.message\n                );\n            });\n*/\n    };\n\n    moveSuccess = ({ operation, data, videoId, videoItemId }) => {\n        console.log('moveSuccess', operation, videoId, videoItemId, data);\n\n        switch (operation) {\n            case 'insert':\n                // console.log(\"insert video \", videoId, data.result.snippet.resourceId.videoId);\n                break;\n            case 'delete':\n                // console.log(\"delete video \", videoItemId);\n                this.removeFromPlaylistState(videoItemId);\n                break;\n            default:\n                console.error(`moveSuccess: unknown operation ${operation}`);\n        }\n\n        // result:\n        //     etag: \"\"XpPGQXPnxQJhLgs6enD_n8JR4Qk/-SMkaVE1qGHUDguCww7-fwlg5AY\"\"\n        // id: \"UExfeDhNcFV5cHhlYksyX0NwSmItT3ROZVVfNTY4eWZCMi41MzJCQjBCNDIyRkJDN0VD\"\n        // kind: \"youtube#playlistItem\"\n        // snippet:\n        //     channelId: \"UCE0q36_agQAeb4G3PXivkew\"\n        // channelTitle: \"François Georgy\"\n        // description: \"Now playing in select cities: gracejonesmovie.com↵↵This electrifying journey through the public and private worlds of pop culture mega-icon Grace Jones contrasts musical sequences with intimate personal footage, all the while brimming with Jones’s bold aesthetic. A larger-than-life entertainer, an androgynous glam-pop diva, an unpredictable media presence – Grace Jones is all these things and more. Sophie Fiennes’s documentary goes beyond the traditional music biography, offering a portrait as stylish and unconventional as its subject. Taking us home with her to Jamaica, into the studio with long-time collaborators Sly & Robbie, and backstage at gigs around the world, the film reveals Jones as lover, daughter, mother, and businesswoman. But the stage is the fixed point to which the film returns, with eye-popping performances of \"Slave to the Rhythm,\" “Pull Up to the Bumper,” \"Love is the Drug,\" and more. Jones herself has said watching the film “will be like seeing me almost naked” and, indeed, Fiennes’s treatment is every bit as definition-defying as its subject, untamed by either age or life itself.\"\n        // playlistId: \"PL_x8MpUypxebK2_CpJb-OtNeU_568yfB2\"\n        // publishedAt: \"2019-01-18T12:35:59.000Z\"\n        // resourceId: {kind: \"youtube#video\", videoId: \"ya7yeAXU_Cw\"}\n        // thumbnails: {default: {…}, medium: {…}, high: {…}, standard: {…}, maxres: {…}}\n        // title: \"Grace Jones: Bloodlight and Bami – Official U.S. Trailer\"\n        // __proto__: Object\n        // __proto__: Object\n        // status: 200\n        // statusText: null\n    };\n\n    moveFailure = r => {\n        console.log('moveFailure', r);\n    };\n\n    moveVisible = () => {\n        console.log('Videos.moveVisible');\n\n        let videoItemIds = [];\n        let videoIds = [];\n\n        this.state.videos\n            .filter(\n                video =>\n                    video.snippet.title\n                        .toLowerCase()\n                        .indexOf(this.state.filter.toLowerCase()) > -1\n            )\n            .map(video => {\n                videoItemIds.push(video.id);\n                if (!videoIds.includes(video.contentDetails.videoId))\n                    videoIds.push(video.contentDetails.videoId); // avoid pushing duplicates\n            });\n\n        console.log('moveVisible', videoIds, videoItemIds);\n\n        console.log('moveMultipleIntoPlaylist before');\n        // moveMultipleIntoPlaylist(videoItemIds, videoIds, this.state.moveToPlaylistId).then(this.moveSuccess, this.moveFailure);\n        moveMultipleIntoPlaylist(\n            videoItemIds,\n            videoIds,\n            this.state.moveToPlaylistId,\n            this.moveSuccess,\n            this.moveFailure\n        );\n        console.log('moveMultipleIntoPlaylist after');\n    };\n\n    setMoveToList = event => {\n        // console.log(\"Videos.setMoveToList\", event.target.value);\n        this.setState({ moveToPlaylistId: event.target.value });\n    };\n\n    updateFilter = event => {\n        // console.log(\"Videos.updateFilter\", event.target.value);\n        let f = event.target.value;\n        this.setState({ filter: f });\n    };\n\n    refresh = (clearFilter = false) => {\n        console.log('refresh');\n\n        if (!this.state.isAuthorized) return;\n\n        this.setState({\n            playlistName: null,\n            videos: null,\n            playlists: null,\n            videosLoading: false,\n            filter: clearFilter ? '' : this.state.filter,\n        });\n\n        this.retrievePlaylistName();\n        this.retrieveVideos();\n        this.retrievePlaylists();\n    };\n\n    render() {\n        const {\n            isAuthorized,\n            playlistId,\n            playlistName,\n            videos,\n            playlists,\n            moveToPlaylistId,\n            filter,\n        } = this.state;\n\n        // console.log(\"Videos.render\", videos);\n\n        if (!isAuthorized) {\n            return <div />;\n        } else {\n            if (videos) {\n                let visibleVideos = videos.filter(\n                    video =>\n                        video.snippet.title\n                            .toLowerCase()\n                            .indexOf(filter.toLowerCase()) > -1\n                );\n                visibleVideos.sort((a, b) => {\n                    if (a.snippet.title < b.snippet.title) {\n                        return -1;\n                    }\n                    if (a.snippet.title > b.snippet.title) {\n                        return 1;\n                    }\n                    // names must be equal\n                    return 0;\n                });\n\n                return (\n                    <div className=\"videos\">\n                        <h2>Videos in {playlistName} :</h2>\n                        <h3>{videos.length} videos</h3>\n                        <button onClick={this.refresh}>refresh</button>\n                        <div className=\"playlist-selector\">\n                            target playlist:\n                            {playlists && (\n                                <select onChange={this.setMoveToList}>\n                                    <option value=\"\">\n                                        select list to move to\n                                    </option>\n                                    {playlists.map((p, i) => {\n                                        return p.id === playlistId ? null : (\n                                            <option key={i} value={p.id}>\n                                                {p.snippet.title}\n                                            </option>\n                                        );\n                                    })}\n                                </select>\n                            )}\n                        </div>\n                        {moveToPlaylistId && (\n                            <div>\n                                <button onClick={this.moveVisible}>\n                                    move visible to target playlist\n                                </button>\n                            </div>\n                        )}\n                        <div className=\"filter\">\n                            filter:{' '}\n                            <input\n                                type=\"text\"\n                                defaultValue={filter}\n                                onKeyUp={this.updateFilter}\n                            />\n                        </div>\n                        <div>\n                            {// videos.filter((video) => video.snippet.title.toLowerCase().indexOf(filter.toLowerCase()) > -1).map((video, index) => {\n                            visibleVideos.map((video, index) => {\n                                return (\n                                    <div key={index}>\n                                        <a href={`https://www.youtube.com/watch?v=${video.contentDetails.videoId}`} target=\"_blank\" rel=\"noopener noreferrer\">{video.snippet.title}</a>\n                                        {' '}\n                                        <button onClick={() => this.remove(video.id)}>remove</button>\n                                        {moveToPlaylistId && (\n                                            <button onClick={() => this.movep(video.id, video.contentDetails.videoId, moveToPlaylistId)}>move</button>\n                                        )}\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n                );\n            } else {\n                return <div>Retrieving the list of videos...</div>;\n            }\n        }\n    }\n\n    /*\n{\n  \"kind\": \"youtube#playlistItem\",\n  \"etag\": \"\\\"DuHzAJ-eQIiCIp7p4ldoVcVAOeY/1tCBTp6eGaB5-FomghShvhm_Vkc\\\"\",\n  \"id\": \"UExfeDhNcFV5cHhlYlBlX1hZeWpKTUo1WVdlOTcyaU9Uci4yODlGNEE0NkRGMEEzMEQy\",\n  \"snippet\": {\n    \"publishedAt\": \"2018-06-19T10:55:25.000Z\",\n    \"channelId\": \"UCE0q36_agQAeb4G3PXivkew\",\n    \"title\": \"Urfaust - The Constellatory Practice (Full Album)\",\n    \"description\": \"Country: The Netherlands | Year: 2018 | Genre: Atmospheric Doom/Black Metal\\n\\nLP & CD available here:\\nhttp://www.van-records.de\\n\\nDigital Album available here:\\nhttps://urfaust.bandcamp.com/album/the-constellatory-practice-2\\n\\n- Urfaust -\\nWebshop: http://www.urfaust.bigcartel.com\\nFacebook: https://www.facebook.com/urfaustofficial\\nBandcamp: http://urfaust.bandcamp.com\\nMetal Archives: http://www.metal-archives.com/bands/Urfaust/19596\\n\\n- Ván Records -\\nWebsite: http://www.van-records.de\\nFacebook: https://www.facebook.com/vanrecs\\nBandcamp: http://vanrecords.bandcamp.com\\nYouTube: https://www.youtube.com/vanrecords\\nSoundcloud: https://soundcloud.com/v-n-records\\n\\nTracklist: \\n1. Doctrine Of Spirit Obsession 00:00\\n2. Behind The Veil Of The Trance Sleep 13:18\\n3. A Course In Cosmic Meditation 21:06\\n4. False Sensorial Impressions 25:40\\n5. Trail Of The Conscience Of The Dead 31:42\\n6. Eradication Through Hypnotic Suggestion 44:27\\n\\nThis video is for promotional use only!\",\n    \"thumbnails\": {\n      \"default\": {\n        \"url\": \"https://i.ytimg.com/vi/ayCHct5hXPc/default.jpg\",\n        \"width\": 120,\n        \"height\": 90\n      },\n      \"medium\": {\n        \"url\": \"https://i.ytimg.com/vi/ayCHct5hXPc/mqdefault.jpg\",\n        \"width\": 320,\n        \"height\": 180\n      },\n      \"high\": {\n        \"url\": \"https://i.ytimg.com/vi/ayCHct5hXPc/hqdefault.jpg\",\n        \"width\": 480,\n        \"height\": 360\n      },\n      \"standard\": {\n        \"url\": \"https://i.ytimg.com/vi/ayCHct5hXPc/sddefault.jpg\",\n        \"width\": 640,\n        \"height\": 480\n      },\n      \"maxres\": {\n        \"url\": \"https://i.ytimg.com/vi/ayCHct5hXPc/maxresdefault.jpg\",\n        \"width\": 1280,\n        \"height\": 720\n      }\n    },\n    \"channelTitle\": \"François Georgy\",\n    \"playlistId\": \"PL_x8MpUypxebPe_XYyjJMJ5YWe972iOTr\",\n    \"position\": 1,\n    \"resourceId\": {\n      \"kind\": \"youtube#video\",\n      \"videoId\": \"ayCHct5hXPc\"\n    }\n  },\n  \"contentDetails\": {\n    \"videoId\": \"ayCHct5hXPc\",\n    \"videoPublishedAt\": \"2018-05-04T10:59:02.000Z\"\n  }\n}\n    */\n}\n\nexport default Videos;\n","import React, { Component } from 'react';\nimport { buildChannelsRequest, executeRequest } from '../utils/gapi';\nimport { Link } from 'react-router-dom';\nimport './Channels.css';\n\n/**\n * Display the list of channels of the authorized user.\n */\nclass Channels extends Component {\n    constructor(props) {\n        super(props);\n        console.log('Channels.constructor', props);\n        this.state = {\n            isAuthorized: false,\n            channels: null,\n            filter: '',\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        console.log('Channels.getDerivedStateFromProps', props);\n        if (props.isAuthorized !== state.isAuthorized) {\n            return {\n                isAuthorized: props.isAuthorized,\n            };\n        }\n\n        // No state update necessary\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        console.log('Channels.componentDidUpdate');\n        // At this point, we're in the \"commit\" phase, so it's safe to load the new data.\n        if (this.state.isAuthorized && this.state.channels === null) {\n            // !!! only retrieve data if state.channels is empty; otherwise this will generate an endless loop.\n            this.retrieve();\n        }\n    }\n\n    store = data => {\n        console.log('Channels.store');\n        if (!data) return;\n        this.setState({\n            channels: data.items[0].contentDetails.relatedPlaylists,\n        });\n    };\n\n    retrieve = nextPageToken => {\n        console.log('Channels.retrieve', nextPageToken);\n        executeRequest(buildChannelsRequest(), this.store);\n    };\n\n    updateFilter = event => {\n        console.log('Channels.updateFilter');\n        if (event.keyCode === 27) {\n            this.setState({ filter: '' });\n        } else {\n            this.setState({ filter: event.target.value });\n        }\n    };\n\n    componentDidMount() {\n        console.log('Channels.componentDidMount');\n        this.retrieve();\n    }\n\n    render() {\n        const { isAuthorized, channels, filter } = this.state;\n\n        console.log('Channels render', channels);\n\n        if (!isAuthorized) {\n            return <div />;\n        } else {\n            if (channels) {\n                return (\n                    <div>\n                        <h2>list of channels</h2>\n                        {/*<div className=\"filter\">*/}\n                        {/*filter: <input type=\"text\" onKeyUp={this.updateFilter} />*/}\n                        {/*</div>*/}\n                        <div>\n                            {Object.keys(channels).map((name, index) => {\n                                return (\n                                    <div key={index}>\n                                        <Link to={`/videos/${channels[name]}`}>\n                                            {name}\n                                        </Link>\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n                );\n            } else {\n                return <div>Retrieving the channels...</div>;\n            }\n        }\n    }\n}\n\nexport default Channels;\n","\nexport function snippetTitleSort(a, b) {\n    return a.snippet.title.toLowerCase() > b.snippet.title.toLowerCase() ? 1 :\n        b.snippet.title.toLowerCase() > a.snippet.title.toLowerCase() ? -1 :\n            0;\n}\n\nexport function snippetPublishedAtSort(a, b) {\n    let d1 = Date.parse(a.snippet.publishedAt);\n    let d2 = Date.parse(b.snippet.publishedAt);\n    return d1 > d2 ? 1 :\n        d2 > d1 ? -1 :\n            0;\n}\n\nexport function snippetPositionSort(a, b) {\n    return a.snippet.position > b.snippet.position ? 1 :\n        b.snippet.position > a.snippet.position ? -1 :\n            0;\n}\n\nexport function contentDetailsPublishedAtSort(a, b) {\n    let d1 = Date.parse(a.contentDetails.publishedAt);\n    let d2 = Date.parse(b.contentDetails.publishedAt);\n    return d1 > d2 ? 1 :\n        d2 > d1 ? -1 :\n            0;\n}\n\nexport function snippetTitleSortReverse(b, a) {\n    return a.snippet.title.toLowerCase() > b.snippet.title.toLowerCase() ? 1 :\n        b.snippet.title.toLowerCase() > a.snippet.title.toLowerCase() ? -1 :\n            0;\n}\n\nexport function snippetPublishedAtSortReverse(b, a) {\n    let d1 = Date.parse(a.snippet.publishedAt);\n    let d2 = Date.parse(b.snippet.publishedAt);\n    return d1 > d2 ? 1 :\n        d2 > d1 ? -1 :\n            0;\n}\n\nexport function snippetPositionSortReverse(b, a) {\n    return a.snippet.position > b.snippet.position ? 1 :\n        b.snippet.position > a.snippet.position ? -1 :\n            0;\n}\n\nexport function contentDetailsPublishedAtSortReverse(b, a) {\n    let d1 = Date.parse(a.contentDetails.publishedAt);\n    let d2 = Date.parse(b.contentDetails.publishedAt);\n    return d1 > d2 ? 1 :\n        d2 > d1 ? -1 :\n            0;\n}\n","import React, {Component, Fragment} from 'react';\nimport {\n    buildPlaylistsRequest,\n    buildPlaylistItemsRequest,\n    executeRequest,\n    moveMultipleIntoPlaylist,\n    copyMultipleIntoPlaylist, removeMultipleFromPlaylist,\n} from '../utils/gapi';\nimport './Videos.css';\nimport {produce} from \"immer\";\nimport {\n    contentDetailsPublishedAtSort, contentDetailsPublishedAtSortReverse,\n    snippetPositionSort, snippetPositionSortReverse,\n    snippetPublishedAtSort, snippetPublishedAtSortReverse,\n    snippetTitleSort, snippetTitleSortReverse\n} from \"../utils/sorting\";\n\nconst SORT_BY_SNIPPET_TITLE = \"snippetTitle\";\nconst SORT_BY_SNIPPET_PUBLISHED_AT = \"snippetPublishedAt\";\nconst SORT_BY_SNIPPET_POSITION = \"snippetPosition\";\nconst SORT_BY_VIDEO_PUBLISHED_AT = \"videoPublishedAt\";\nconst SORT_ASCENDING = true;    // false means sort descending\n\n\nclass TwinVideos extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            isAuthorized: false,\n            videosLoading: false,\n            playlists: null,\n            sync: false,\n            lists: [{\n                playlistId: null,\n                videos: [],\n                filter: '',\n                sortMethod: SORT_BY_SNIPPET_TITLE,\n                sortDirection: SORT_ASCENDING,\n                errorMessage: null,\n                marked: []      // list of VideoId (ID within the playlist)\n            },{\n                playlistId: null,\n                videos: [],\n                filter: '',\n                sortMethod: SORT_BY_SNIPPET_TITLE,\n                sortDirection: SORT_ASCENDING,\n                errorMessage: null,\n                marked: []      // list of VideoId (ID within the playlist)\n            }]\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        // console.log(\"TwinVideos.getDerivedStateFromProps\", props);\n        if (props.isAuthorized !== state.isAuthorized) {\n            return {\n                isAuthorized: props.isAuthorized,\n            };\n        }\n        // No state update necessary\n        return null;\n    }\n\n    componentDidMount() {\n        // console.log('TwinVideos.componentDidMount');\n        this.refresh();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n        // At this point, we're in the \"commit\" phase, so it's safe to load the new data.\n\n        // console.log(`TwinVideos.componentDidUpdate, playlistId=${this.state.playlistId}, prev=${prevState.playlistId}`, this.state);\n\n        if (!this.state.isAuthorized) return;\n\n/*\n        if (\n            !this.state.videosLoading &&\n            this.state.playlistId &&\n            this.state.videos === null\n        ) {\n            // !!! only retrieve data if state.videos is empty; otherwise this will generate an endless loop.\n            console.log('TwinVideos.componentDidUpdate: call retrieveVideos');\n            this.retrieveVideos();\n        }\n*/\n\n        if (this.state.playlists === null) {\n            // !!! only retrieve data if state.playlists is empty; otherwise this will generate an endless loop.\n            // console.log('TwinVideos.componentDidUpdate: call retrievePlaylists');\n            this.retrievePlaylists();\n        }\n    }\n\n    setSortMethod = (listIndex, method) => {\n        // if same method, then flip the direction\n        this.setState(\n            produce(draft => {\n                if (draft.lists[listIndex].sortMethod === method) {\n                    draft.lists[listIndex].sortDirection = !draft.lists[listIndex].sortDirection;\n                } else {\n                    draft.lists[listIndex].sortMethod = method;\n                }\n            })\n        );\n    };\n\n    getSortFunction = (listIndex) => {\n        let asc = this.state.lists[listIndex].sortDirection;\n        switch(this.state.lists[listIndex].sortMethod) {\n            case SORT_BY_SNIPPET_TITLE : return asc ? snippetTitleSort : snippetTitleSortReverse;\n            case SORT_BY_SNIPPET_PUBLISHED_AT : return asc ? snippetPublishedAtSort : snippetPublishedAtSortReverse;\n            case SORT_BY_SNIPPET_POSITION : return asc ? snippetPositionSort : snippetPositionSortReverse;\n            case SORT_BY_VIDEO_PUBLISHED_AT : return asc ? contentDetailsPublishedAtSort : contentDetailsPublishedAtSortReverse;\n            default : return snippetTitleSort;\n        }\n    };\n\n    storePlaylists = data => {\n\n        // console.log(\"TwinVideos.storePlayLists\", data.items);\n\n        if (!data) return;\n\n        let list = data.items;\n        list.sort(snippetTitleSort);\n        this.setState({ playlists: list });\n    };\n\n    storeVideos = (listIndex, data, currentToken) => {\n\n        // console.log('TwinVideos.storeVideos', currentToken);\n\n        if (!data) return;\n\n        let list = data.items;\n        list.sort(snippetTitleSort);\n\n        this.setState(\n            produce(draft => {\n                if (currentToken === undefined || !currentToken) {\n                    draft.lists[listIndex].videos = list;\n                } else {\n                    draft.lists[listIndex].videos = [...draft.lists[listIndex].videos, ...list]\n                }\n            })\n        );\n\n        if (data.nextPageToken) {\n            // console.log('TwinVideos.storeVideos: get next page with token ' + data.nextPageToken);\n            this.retrieveVideos(listIndex, data.nextPageToken);\n        }\n    };\n\n    retrieveVideos = (listIndex, nextPageToken) => {\n        // console.log(`TwinVideos.retrieveVideos, playlistId=${this.state.playlistId}, pageToken=${nextPageToken}`);\n        // console.log(`TwinVideos.retrieveVideos set videosLoading=true`);\n        this.setState({ errorMessage: null, videosLoading: true });\n        executeRequest(\n            buildPlaylistItemsRequest(this.state.lists[listIndex].playlistId, nextPageToken),\n            data => this.storeVideos(listIndex, data, nextPageToken)\n        );\n    };\n\n    retrievePlaylists = () => {\n        // console.log(\"TwinVideos.retrievePlayLists\");\n        executeRequest(buildPlaylistsRequest(), this.storePlaylists);\n    };\n\n    refreshPlaylists = () => {\n        this.retrievePlaylists();\n    };\n\n    refreshPlaylist = (listIndex) => {\n        // console.log(`refreshPlaylist(${listIndex})`);\n        this.setState(\n            produce(draft => {\n                draft.lists[listIndex].errorMessage = null;\n                draft.lists[listIndex].videos = [];\n            }),\n            () => this.retrieveVideos(listIndex)\n        );\n    };\n\n    setPlaylist = (event, listIndex) => {\n        // console.log(\"TwinVideos.setMoveToList\", event.target.value, listIndex, this.state);\n        let id = event.target.value;\n        this.setState(\n            produce(draft => {\n                draft.lists[listIndex].errorMessage = null;\n                // console.log(\"draft\", draft.lists);\n                // console.log(\"target\", event.target);\n                draft.lists[listIndex].playlistId = id;\n            }),\n            () => this.retrieveVideos(listIndex)\n        );\n    };\n\n    removeFromPlaylistState = (listIndex, playlistItemIds) => {\n        // console.log(\"TwinVideos.removeFromPlaylistState\", playlistItemId);\n        this.setState(\n            produce(draft => {\n                let videos = draft.lists[listIndex].videos;\n                for (let i=0; i<playlistItemIds.length; i++) {\n                    let k = videos.findIndex(video => video.id === playlistItemIds[i]);\n                    if (k >= 0) videos.splice(k, 1);\n                }\n                draft.lists[listIndex].videos = videos;\n                draft.lists[listIndex].errorMessage = null;\n            })  //,\n            //() => this.retrieveVideos(playlistIndex)\n        );\n    };\n\n    // insertSuccess = (listIndex, { operation, data, videoId, playlistItemId }) => {\n    //     console.log('moveSuccess', operation, videoId, playlistItemId, data);\n    //     this.refreshPlaylist(listIndex);\n    // };\n\n    // removeSuccess = (listIndex, { operation, data, videoId, playlistItemId }) => {\n    //     console.log('moveSuccess', operation, videoId, playlistItemId, data);\n    //     this.removeFromPlaylistState(listIndex, playlistItemId);\n    // };\n\n    getVisibleIds = listIndex => {\n\n        // console.log(`getVisibleIds(${listIndex})`, this.state);\n\n        let filter = this.state.lists[listIndex].filter.toLowerCase();\n\n        let playlistItemIds = [];\n        let videoIds = [];\n\n        this.state.lists[listIndex].videos\n            .filter(playlistItem => playlistItem.snippet.title.toLowerCase().indexOf(filter) > -1)\n            .forEach(playlistItem => {\n                playlistItemIds.push(playlistItem.id);\n                if (!videoIds.includes(playlistItem.contentDetails.videoId)) {\n                    videoIds.push(playlistItem.contentDetails.videoId); // avoid pushing duplicates\n                }\n            });\n\n        return {\n            playlistItemIds,\n            videoIds\n        }\n    };\n\n    mark = (listIndex, playlistItemIds) => {\n        this.setState(\n            produce(draft => {\n                draft.lists[listIndex].marked = Array.isArray(playlistItemIds) ? playlistItemIds : [playlistItemIds];   // IDs within the playlist\n            })\n        );\n    };\n\n    clearMarked = (listIndex) => {\n        this.setState(\n            produce(draft => {\n                draft.lists[listIndex].marked = [];\n            })\n        );\n    };\n\n    progress = (listIndex, {videoId, playlistItemId}) => {\n        // console.log(\"progress\", videoId, playlistItemId);\n        this.setState(\n            produce(draft => {\n                let k = draft.lists[listIndex].marked.findIndex(id => id === playlistItemId);\n                // console.log(\"progress k\", k, videoId);\n                if (k >= 0) draft.lists[listIndex].marked.splice(k, 1);\n            })\n        );\n    };\n\n    failure = (listIndex, error) => {\n        this.setState(\n            produce(draft => {\n                draft.lists[listIndex].errorMessage = error.message;\n            })\n        );\n    };\n\n    copy = (sourceListIndex, targetListIndex, playlistItemId, videoId) => {\n        // console.log('copy', sourceListIndex, targetListIndex, playlistItemId, videoId);\n        this.mark(sourceListIndex, playlistItemId);\n        copyMultipleIntoPlaylist(\n            [playlistItemId],\n            [videoId],\n            this.state.lists[targetListIndex].playlistId,\n            (data) => this.progress(sourceListIndex, data),\n            () => {\n                this.retrievePlaylists();   // update the number of videos per playlist displayed in the dropdown select\n                this.refreshPlaylist(targetListIndex);\n            },\n            (data) => this.failure(sourceListIndex, data.error));\n    };\n\n    copyAll = (sourceListIndex, targetListIndex) => {\n        // console.log('move', sourceListIndex, targetListIndex, playlistItemId, videoId);\n        const { playlistItemIds, videoIds } = this.getVisibleIds(sourceListIndex);\n        this.mark(sourceListIndex, playlistItemIds);\n        copyMultipleIntoPlaylist(\n            playlistItemIds,\n            videoIds,\n            this.state.lists[targetListIndex].playlistId,\n            (data) => this.progress(sourceListIndex, data),\n            () => {\n                this.retrievePlaylists();   // update the number of videos per playlist displayed in the dropdown select\n                this.refreshPlaylist(targetListIndex);\n                this.clearMarked(sourceListIndex);\n            },\n            (data) => this.failure(sourceListIndex, data.error));\n    };\n\n    move = (sourceListIndex, targetListIndex, playlistItemId, videoId) => {\n        // console.log('move', sourceListIndex, targetListIndex, playlistItemId, videoId);\n        this.mark(sourceListIndex, playlistItemId);\n        moveMultipleIntoPlaylist(\n            [playlistItemId],\n            [videoId],\n            this.state.lists[targetListIndex].playlistId,\n            (data) => {\n                this.progress(sourceListIndex, data);\n                this.removeFromPlaylistState(sourceListIndex, [data.playlistItemId]);\n            },\n            () => {\n                this.retrievePlaylists();   // update the number of videos per playlist displayed in the dropdown select\n                this.refreshPlaylist(targetListIndex);\n                this.clearMarked(sourceListIndex);\n            },\n            (data) => this.failure(sourceListIndex, data.error));\n    };\n\n    moveAll = (sourceListIndex, targetListIndex) => {\n        // console.log('move', sourceListIndex, targetListIndex, playlistItemId, videoId);\n        const { playlistItemIds, videoIds } = this.getVisibleIds(sourceListIndex);\n        this.mark(sourceListIndex, playlistItemIds);\n        moveMultipleIntoPlaylist(\n            playlistItemIds,\n            videoIds,\n            this.state.lists[targetListIndex].playlistId,\n            (data) => {\n                this.progress(sourceListIndex, data);\n                this.removeFromPlaylistState(sourceListIndex, [data.playlistItemId]);\n            },\n            () => {\n                this.retrievePlaylists();   // update the number of videos per playlist displayed in the dropdown select\n                this.refreshPlaylist(targetListIndex);\n                this.clearMarked(sourceListIndex);\n            },\n            (data) => this.failure(sourceListIndex, data.error));\n    };\n\n    remove = (listIndex, playlistItemId, videoId) => {\n        // console.log('remove', listIndex, playlistItemId, videoId);\n        this.mark(listIndex, playlistItemId);\n        removeMultipleFromPlaylist(\n            [playlistItemId],\n            [videoId],\n            this.state.lists[listIndex].playlistId,\n            (data) => this.progress(listIndex, data),\n            () => {\n                this.removeFromPlaylistState(listIndex, [playlistItemId]);\n                this.clearMarked(listIndex);\n            },\n            (data) => this.failure(listIndex, data.error));\n\n    };\n\n    removeAll = (listIndex) => {\n        // console.log('remove');\n        const { playlistItemIds, videoIds } = this.getVisibleIds(listIndex);\n        this.mark(listIndex, playlistItemIds);\n        removeMultipleFromPlaylist(\n            playlistItemIds,\n            videoIds,\n            this.state.lists[listIndex].playlistId,\n            (data) => this.progress(listIndex, data),\n            () => {\n                this.removeFromPlaylistState(listIndex, playlistItemIds);\n                this.clearMarked(listIndex);\n            },\n            (data) => this.failure(listIndex, data.error));\n    };\n\n    updateFilter = (event, listIndex) => {\n        // console.log(\"TwinVideos.updateFilter\", event.target.value);\n        let f = event.target.value;\n        this.setState(\n            produce(draft => {\n                for (let i=0; i<draft.lists.length; i++) {\n                    if (draft.sync || i === listIndex) {\n                        draft.lists[i].errorMessage = null;\n                        draft.lists[i].filter = f;\n                    }\n                }\n            })\n        );\n    };\n\n    clearFilter = listIndex => {\n        this.setState(\n            produce(draft => {\n                draft.lists[listIndex].filter = '';\n            })\n        );\n    };\n\n    refresh = (listIndex, clearFilter = false) => {\n        // console.log('refresh');\n        if (!this.state.isAuthorized) return;\n        this.setState(\n            produce(draft => {\n                draft.videosLoading = false;\n                draft.playlists = null;\n                for (let i=0; i<draft.lists; i++) {\n                    draft.lists[i] = {\n                        playlistId: null,\n                        videos: [],\n                        filter: clearFilter ? '' : draft.lists[i].filter,\n                        errorMessage: null\n                    }\n                }\n            }),\n            () => this.retrievePlaylists()\n        );\n    };\n\n    dismissErrorMessage = (listIndex) => {\n        this.setState(produce(draft => {\n            draft.lists[listIndex].errorMessage = null;\n        }));\n    };\n\n    toggleSync = () => {\n        this.setState({sync: !this.state.sync});\n    };\n\n\n    render() {\n\n        const { isAuthorized, playlists, lists, sortDirection, sync } = this.state;\n\n        // console.log(\"render\", lists);\n\n        if (!isAuthorized) {\n            return <div />;\n        } else {\n            return (\n                <div className=\"lists\">\n                {\n                    lists.map((list, listIndex) => {\n                        // console.log(\"list.marked\", list.marked);\n                        let sortMethod = lists[listIndex].sortMethod;\n                        let filt = list.filter.toLowerCase();\n                        let visibleVideos = list.videos\n                            .filter(video => video.snippet.title.toLowerCase().indexOf(filt) > -1)\n                            .sort(this.getSortFunction(listIndex));\n                        return (\n                            <div className=\"videos\" key={listIndex}>\n                                {playlists &&\n                                <div className=\"playlist-selector\">\n                                    <select onChange={(event) => this.setPlaylist(event, listIndex)}>\n                                        <option defaultValue={list.playlistId}>select playlist...</option>\n                                        {playlists.map((p, i) => <option key={i} value={p.id}>{p.snippet.title}</option>)}\n                                    </select> <button onClick={this.refreshPlaylists}>refresh</button>\n                                    {' '}\n                                    {list.playlistId && <a href={`https://www.youtube.com/playlist?list=${list.playlistId}`} target=\"_blank\" rel=\"noopener noreferrer\">open in YouTube</a>}\n                                </div>\n                                }\n                                {list.errorMessage &&\n                                <div className=\"messages\">\n                                    <div className=\"error\">{list.errorMessage}<div className=\"dismiss\"><button onClick={() => this.dismissErrorMessage(listIndex)}>dismiss</button></div></div>\n                                </div>\n                                }\n                                {list.videos && list.videos.length > 0 &&\n                                <Fragment>\n                                    <div className=\"infos\">\n                                        There are {list.videos.length} videos in this playlist.\n                                        <button onClick={() => this.refreshPlaylist(listIndex)}>refresh the list of videos</button>\n                                    </div>\n                                    {/*<button onClick={() => this.refresh(listIndex)}>refresh</button>*/}\n                                    <div className=\"filtering\">\n                                        {listIndex === 0 &&\n                                        <div className=\"sync\">\n                                            <button onClick={this.toggleSync}>sync filter&sorting: {sync ? \"ON\" : \"OFF\"}</button>\n                                        </div>\n                                        }\n                                        <div className=\"filter\">\n                                            Filter: <input type=\"text\" value={list.filter} onChange={(event) => this.updateFilter(event, listIndex)} />\n                                            <button onClick={() => this.clearFilter(listIndex)}>clear filter</button>\n                                            {visibleVideos.length} videos shown\n                                        </div>\n                                    </div>\n                                    {visibleVideos.length > 0 &&\n                                    <div>\n                                        {listIndex % 2\n                                            ? <div className=\"batch-actions\">\n                                                Apply to all videos shown below:\n                                                <button title=\"remove shown videos from the playlist\" onClick={() => this.removeAll(listIndex)}><i className=\"fas fa-trash-alt\"></i> remove all</button>\n                                                <button onClick={() => this.copyAll(listIndex, listIndex - 1)}><i className=\"fas fa-angle-double-left\"></i> copy all</button>\n                                                <button onClick={() => this.moveAll(listIndex, listIndex - 1)}><i className=\"fas fa-angle-left\"></i> move all</button>\n                                            </div>\n                                            : <div className=\"batch-actions\">\n                                                Apply to all videos shown below:\n                                                <button title=\"remove shown videos from the playlist\" onClick={() => this.removeAll(listIndex)}><i className=\"fas fa-trash-alt\"></i> remove all</button>\n                                                <button onClick={() => this.copyAll(listIndex, listIndex + 1)}>copy all <i className=\"fas fa-angle-double-right\"></i></button>\n                                                <button onClick={() => this.moveAll(listIndex, listIndex + 1)}>move all <i className=\"fas fa-angle-right\"></i></button>\n                                            </div>\n                                        }\n                                    </div>\n                                    }\n                                    <div className=\"sorting\">\n                                        <button onClick={() => this.setSortMethod(listIndex, SORT_BY_SNIPPET_TITLE)} className={sortMethod === SORT_BY_SNIPPET_TITLE ? \"text-button active\" : \"text-button\"}>\n                                            title<i className={sortDirection ? \"fas fa-sort-alpha-down\" : \"fas fa-sort-alpha-up\"}></i>\n                                        </button>\n                                        <button onClick={() => this.setSortMethod(listIndex, SORT_BY_SNIPPET_PUBLISHED_AT)} className={sortMethod === SORT_BY_SNIPPET_PUBLISHED_AT ? \"text-button active\" : \"text-button\"}>\n                                            added to playlist<i className={sortDirection ? \"fas fa-sort-numeric-down\" : \"fas fa-sort-numeric-up\"}></i>\n                                        </button>\n                                        <button onClick={() => this.setSortMethod(listIndex, SORT_BY_VIDEO_PUBLISHED_AT)} className={sortMethod === SORT_BY_VIDEO_PUBLISHED_AT ? \"text-button active\" : \"text-button\"}>\n                                            video created<i className={sortDirection ? \"fas fa-sort-numeric-down\" : \"fas fa-sort-numeric-up\"}></i>\n                                        </button>\n                                        <button onClick={() => this.setSortMethod(listIndex, SORT_BY_SNIPPET_POSITION)} className={sortMethod === SORT_BY_SNIPPET_POSITION ? \"text-button active\" : \"text-button\"}>\n                                            position<i className={sortDirection ? \"fas fa-sort-numeric-down\" : \"fas fa-sort-numeric-up\"}></i>\n                                        </button>\n                                    </div>\n                                    <div className=\"rows\">\n                                    {\n                                        visibleVideos.map((video, index) => {\n                                            // console.log(\"video.id\", video.id);\n                                            let m = list.marked.includes(video.id) ? 'marked' : '';\n                                            return (\n                                                <div key={index} className={`row row-${index % 2} ${m}`}>\n                                                    {listIndex % 2\n                                                        ? <div>\n                                                            <button className=\"action-button\" onClick={\n                                                                () => this.move(listIndex, listIndex - 1,\n                                                                    video.id, /* ID within the playlist */\n                                                                    video.contentDetails.videoId /* ID within youtube */\n                                                                )}>\n                                                                <i className=\"fas fa-angle-left\"></i> move\n                                                            </button>\n                                                            <button className=\"action-button\" onClick={\n                                                                () => this.copy(listIndex, listIndex - 1,\n                                                                    video.id, /* ID within the playlist */\n                                                                    video.contentDetails.videoId /* ID within youtube */\n                                                                )}>\n                                                                <i className=\"fas fa-angle-double-left\"></i> copy\n                                                            </button>\n                                                        </div>\n                                                        : <div>\n                                                            <button className=\"action-button\" title=\"remove from this playlist\" onClick={\n                                                                () => this.remove(listIndex,\n                                                                    video.id, /* ID within the playlist */\n                                                                    video.contentDetails.videoId /* ID within youtube */\n                                                                )}>\n                                                                <i className=\"fas fa-trash-alt\"></i>\n                                                            </button>\n                                                        </div>\n                                                    }\n                                                    <div className=\"video-title\">\n                                                        <a href={`https://www.youtube.com/watch?v=${video.contentDetails.videoId}`} target=\"_blank\" rel=\"noopener noreferrer\">{video.snippet.title}</a>\n                                                    </div>\n                                                    {listIndex % 2\n                                                        ? <div>\n                                                            <button className=\"action-button\" title=\"remove from this playlist\" onClick={\n                                                                () => this.remove(listIndex,\n                                                                    video.id, /* ID within the playlist */\n                                                                    video.contentDetails.videoId /* ID within youtube */\n                                                                )}>\n                                                                <i className=\"fas fa-trash-alt\"></i>\n                                                            </button>\n                                                        </div>\n                                                        : <div>\n                                                            <button className=\"action-button\" onClick={\n                                                                () => this.copy(listIndex, listIndex + 1,\n                                                                    video.id, /* ID within the playlist */\n                                                                    video.contentDetails.videoId /* ID within youtube */\n                                                                )}>copy <i className=\"fas fa-angle-double-right\"></i>\n                                                            </button>\n                                                            <button className=\"action-button\" onClick={\n                                                                () => this.move(listIndex, listIndex + 1,\n                                                                    video.id, /* ID within the playlist */\n                                                                    video.contentDetails.videoId /* ID within youtube */\n                                                                )}>move <i className=\"fas fa-angle-right\"></i>\n                                                            </button>\n                                                        </div>\n                                                    }\n                                                </div>\n                                            )}\n                                        )\n                                    }\n                                    </div>\n                                </Fragment>}\n                            </div>\n                        )\n                    })\n                }\n                </div>\n            );\n        }\n    }\n\n}\n\nexport default TwinVideos;\n","import React, {Component, Fragment} from 'react';\nimport {\n    buildApiRequest, buildChannelPlaylistsRequest, buildPlaylistItemsRequest,\n    buildSubscriptionsRequest,\n    executeRequest,\n} from '../utils/gapi';\nimport { Link } from 'react-router-dom';\nimport './Subscriptions.css';\nimport {produce} from \"immer\";\nimport {snippetTitleSort} from \"../utils/sorting\";\n\n/**\n * Display the list of subscriptions of the authorized user.\n */\nclass Subscriptions extends Component {\n\n    constructor(props) {\n        super(props);\n        // console.log('Subscriptions.constructor', props);\n        this.state = {\n            isAuthorized: false,\n            subscriptions: null,\n            subscriptionsPlaylists: {},\n            // newSubscription: '',\n            filter: '',\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        // console.log('Subscriptions.getDerivedStateFromProps', props);\n        if (props.isAuthorized !== state.isAuthorized) {\n            return {\n                isAuthorized: props.isAuthorized,\n            };\n        }\n\n        // No state update necessary\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log('Subscriptions.componentDidUpdate');\n        // At this point, we're in the \"commit\" phase, so it's safe to load the new data.\n        if (this.state.isAuthorized && this.state.subscriptions === null) {\n            // !!! only retrieve data if state.subscriptions is empty; otherwise this will generate an endless loop.\n            this.retrieve();\n        }\n    }\n\n    // newSubscriptionName = event => {\n    //     console.log('Subscriptions.newSubscriptionName');\n    //     this.setState({ newSubscription: event.target.value });\n    // };\n\n    // createSubscription = () => {\n    //     if (!this.state.newSubscription) return;\n    //     let request = buildApiRequest(\n    //         'POST',\n    //         '/youtube/v3/subscriptions',\n    //         {\n    //             part: 'snippet,status',\n    //             onBehalfOfContentOwner: '',\n    //         },\n    //         {\n    //             'snippet.title': this.state.newSubscription,\n    //             'snippet.description': '',\n    //             'snippet.tags[]': '',\n    //             'snippet.defaultLanguage': '',\n    //             'status.privacyStatus': 'private', // unlisted, private, public    https://developers.google.com/youtube/v3/docs/subscriptions#resource\n    //         }\n    //     );\n    //     //executeRequest(request, () => { this.insertSuccess(videoItemId) }, this.insertError);\n    //     executeRequest(\n    //         request,\n    //         resp => {\n    //             console.log('created subscription', resp);\n    //             this.retrieve();\n    //         },\n    //         this.createError\n    //     );\n    // };\n\n    store = (data, currentToken) => {\n\n        // console.log('Subscriptions.store', data);\n        if (!data) return;\n\n        let list = data.items;\n        list.sort(snippetTitleSort);\n\n        this.setState(\n            produce(draft => {\n                if (currentToken === undefined || !currentToken) {\n                    draft.subscriptions = list;\n                } else {\n                    draft.subscriptions = [...draft.subscriptions, ...list]\n                }\n            })\n        );\n\n        if (data.nextPageToken) {\n            // console.log('TwinVideos.storeVideos: get next page with token ' + data.nextPageToken);\n            this.retrieve(data.nextPageToken);\n        }\n\n        // let list = data.items;\n        // list.sort(function(a, b) {\n        //     return a.snippet.title.toLowerCase() > b.snippet.title.toLowerCase()\n        //         ? 1\n        //         : b.snippet.title.toLowerCase() > a.snippet.title.toLowerCase()\n        //         ? -1\n        //         : 0;\n        // });\n        // this.setState({ subscriptions: list });\n    };\n\n    retrieve = nextPageToken => {\n        // console.log('Subscriptions.retrieve', nextPageToken);\n        executeRequest(\n            buildSubscriptionsRequest(nextPageToken),\n            data => this.store(data, nextPageToken)\n        );\n    };\n\n    storeChannelPlaylist = (channelId, data) => {\n        // console.log(\"storeChannelPlaylist\", data);\n        const list = data.items;\n        list.sort(snippetTitleSort);\n        this.setState(\n            produce(draft => {\n                draft.subscriptionsPlaylists[channelId] = list;\n            })\n        );\n    };\n\n    retrieveChannelPlaylists = (channelId) => {\n        // console.log(`retrieveChannelPlaylists(${channelId})`);\n        executeRequest(\n            buildChannelPlaylistsRequest(channelId),\n            data => this.storeChannelPlaylist(channelId, data)\n        );\n    };\n\n    updateFilter = event => {\n        // console.log('Subscriptions.updateFilter');\n        if (event.keyCode === 27) {\n            this.setState({ filter: '' });\n        } else {\n            this.setState({ filter: event.target.value });\n        }\n    };\n\n    clearFilter = () => {\n        this.setState({filter: ''});\n    };\n\n    refresh = () => {\n        this.retrieve();\n    };\n\n    componentDidMount() {\n        // console.log('Subscriptions.componentDidMount');\n        this.retrieve();\n    }\n\n    /*\n{\n   \"kind\":\"youtube#subscription\",\n   \"etag\":\"\\\"DuHzAJ-eQIiCIp7p4ldoVcVAOeY/0v8-koTMYYwrjjH091gV-uVnD7w\\\"\",\n   \"id\":\"PL_x8MpUypxebPqAdp-FT7MeViRdJyVlwR\",\n   \"snippet\":{\n      \"publishedAt\":\"2015-10-04T21:36:35.000Z\",\n      \"channelId\":\"UCE0q36_agQAeb4G3PXivkew\",\n      \"title\":\"trailers\",\n      \"description\":\"\",\n      \"thumbnails\":{\n         \"default\":{\n            \"url\":\"https://i.ytimg.com/vi/z5gxjvYDPJQ/default.jpg\",\n            \"width\":120,\n            \"height\":90\n         },\n         \"medium\":{\n            \"url\":\"https://i.ytimg.com/vi/z5gxjvYDPJQ/mqdefault.jpg\",\n            \"width\":320,\n            \"height\":180\n         },\n         \"high\":{\n            \"url\":\"https://i.ytimg.com/vi/z5gxjvYDPJQ/hqdefault.jpg\",\n            \"width\":480,\n            \"height\":360\n         }\n      },\n      \"channelTitle\":\"François Georgy\",\n      \"localized\":{\n         \"title\":\"trailers\",\n         \"description\":\"\"\n      }\n   },\n   \"contentDetails\":{\n      \"itemCount\":3\n   }\n}\n    */\n\n    render() {\n        const { isAuthorized, subscriptions, subscriptionsPlaylists, filter } = this.state;\n\n        // console.log('Subscriptions render');\n\n        const filt = filter.toLowerCase();\n\n        if (!isAuthorized) {\n            return <div />;\n        } else {\n            if (subscriptions) {\n                return (\n                    <div>\n                        <h2>list of subscriptions</h2>\n                        <h3>{subscriptions.length} subscriptions</h3>\n                        <button onClick={this.refresh}>refresh</button>\n                        <div className=\"filter\">\n                            filter:{' '}\n                            <input type=\"text\" onKeyUp={this.updateFilter} />\n                            <button onClick={this.clearFilter}>clear filter</button>\n                        </div>\n                        <div className=\"subscriptions-list\">\n                            {subscriptions\n                                .filter(p => (p.snippet.title.toLowerCase().indexOf(filt) > -1) || (p.snippet.description.toLowerCase().indexOf(filt) > -1))\n                                .map((subscription, index) => {\n                                    // console.log(subscription);\n                                    const chanId = subscription.snippet.resourceId.channelId;\n                                    return (\n                                        <Fragment key={index}>\n                                            <div>\n                                                <Link to={`/videos/${subscription.id}`}>\n                                                    {subscription.snippet.title}\n                                                </Link>\n                                                <a href={`https://www.youtube.com/channel/${chanId}`} target=\"_blank\" rel=\"noopener noreferrer\">open</a>\n                                            </div>\n                                            <div>\n                                                {subscription.snippet.description}\n                                                {' '}<button onClick={() => this.retrieveChannelPlaylists(chanId)}>show playlists</button>\n                                                {subscriptionsPlaylists[chanId] &&\n                                                <div className=\"channel-playlists\">\n                                                    {subscriptionsPlaylists[chanId].map(\n                                                        (item, index) => {\n                                                            return (\n                                                                <a key={index} href={`https://www.youtube.com/playlist?list=${item.id}`} target=\"_blank\" rel=\"noopener noreferrer\">{item.snippet.title} ({item.contentDetails.itemCount})</a>\n                                                            );\n                                                        }\n                                                    )}\n                                                </div>\n                                                }\n                                            </div>\n                                        </Fragment>\n                                    );\n                                    // return <div key={index}><a href={`#${subscription.id}`}>{subscription.snippet.title}</a> ({subscription.contentDetails.itemCount} videos)</div>\n                                })}\n                        </div>\n                    </div>\n                );\n            } else {\n                return <div>Retrieving the subscriptions...</div>;\n            }\n        }\n    }\n}\n\nexport default Subscriptions;\n","import React, { Component } from 'react';\nimport './App.css';\nimport Playlists from './components/Playlists';\nimport Videos from './components/Videos';\nimport { BrowserRouter as Router, Route, Link, Switch } from 'react-router-dom';\nimport Channels from './components/Channels';\nimport TwinVideos from \"./components/TwinVideos\";\nimport Subscriptions from \"./components/Subscriptions\";\n// import { library } from '@fortawesome/fontawesome-svg-core'\n// import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n//\n// library.add(faAngleDoubleRight);\n\n\n/*\n    gapi.load\n    gapi.client.init\n    gapi.auth2.getAuthInstance\n    <authorize button>\n    instance.signIn\n    user.getBasicProfile\n*/\n\nclass App extends Component {\n    //TODO: toggle authorized button once authorized\n\n    state = {\n        google_api: null,\n        user: null,\n        isAuthorized: false,\n    };\n\n    /**\n     * Called on update of sign-in status\n     */\n    setSigninStatus = () => {\n        console.log('setSigninStatus', this.state.google_api);\n        if (this.state.google_api) {\n            // console.log(\"* instance.currentUser.get()\");\n            let user = this.state.google_api.currentUser.get();\n\n            // console.log(\"setSigninStatus: user\", user);\n\n            let isAuthorized = user.hasGrantedScopes(\n                'https://www.googleapis.com/auth/youtube.force-ssl https://www.googleapis.com/auth/youtubepartner'\n            );\n            this.setState({\n                user: user,\n                isAuthorized: isAuthorized,\n            });\n        }\n    };\n\n    updateSigninStatus = () => {\n        // console.log(\"updateSigninStatus\");\n        this.setSigninStatus();\n    };\n\n    initClient = () => {\n        console.log('initClient');\n\n        // console.log(\"* gapi.client.init\");\n        window.gapi.client\n            .init({\n                clientId:\n                    '1035406715321-fu4ktringpl82201dm2g9fm674akd203.apps.googleusercontent.com',\n                discoveryDocs: [\n                    'https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest',\n                ],\n                scope:\n                    'https://www.googleapis.com/auth/youtube.force-ssl https://www.googleapis.com/auth/youtubepartner', //,\n                // 'access_type': 'offline'\n            })\n            .then(() => {\n                console.log('initClient: success');\n\n                // console.log(\"* gapi.auth2.getAuthInstance\");\n                let inst = window.gapi.auth2.getAuthInstance(); // https://developers.google.com/api-client-library/javascript/reference/referencedocs#gapiauth2getauthinstance\n                // console.log(\"initClient: google_api\", inst);\n\n                // Listen for sign-in state changes\n                inst.isSignedIn.listen(this.updateSigninStatus);\n\n                // Handle initial sign-in state. (Determine if user is already signed in.)\n                this.setSigninStatus();\n                this.setState({ google_api: inst });\n            })\n            .catch(function(e) {\n                console.warn('initClient: auth error: ', e);\n            });\n    };\n\n    authorize = () => {\n\n        console.log('authorize');\n\n        let auth = window.gapi.auth2.getAuthInstance();\n        auth.grantOfflineAccess().then(function(resp) {\n            // console.log(\"authorize grantOfflineAccess\",resp);\n            var auth_code = resp.code;\n        });\n\n        // console.log(\"* instance.signIn\");\n        this.state.google_api.signIn().then(user => {\n            // console.log(\"signIn return, user\", user);\n\n            /*\n\n                // https://stackoverflow.com/questions/32848870/googleuser-object-does-not-have-grantofflineaccess-method\n                user.grantOfflineAccess({\n                    authuser: user.getAuthResponse().session_state.extraQueryParams.authuser\n                }).then(function(resp) {\n                    console.log(\"grantOfflineAccess\",resp);\n                    var auth_code = resp.code;\n\n                    // !!! Allow popup\n\n                    // {code: \"4/AABatlLl3D2rnSW7vIMcgAaua0uvaZ4oEvy5c2Q_3_NJpEDOk25y6zN8Pr7eBB8rsZ6wv0PQP_Rz_7ZABEccn4k\"}\n                });\n*/\n\n            // console.log(\"* user.getBasicProfile\");\n            let p = user.getBasicProfile();\n            // console.log(\"signIn return, user profile\", p);\n            let isAuthorized = user.hasGrantedScopes(\n                'https://www.googleapis.com/auth/youtube.force-ssl https://www.googleapis.com/auth/youtubepartner'\n            );\n            // console.log(\"signIn return, isAuthorized=\" + isAuthorized);\n            this.setState({\n                user: user,\n                userProfile: p,\n                isAuthorized: isAuthorized,\n            });\n        });\n    };\n\n    grantAccess = () => {\n        // console.log(\"grantAccess\");\n\n        let auth = window.gapi.auth2.getAuthInstance();\n        // let user = auth.currentUser.get();\n\n        // console.log(\"grantAccess\", user);\n        //\n        // https://stackoverflow.com/questions/32848870/googleuser-object-does-not-have-grantofflineaccess-method\n        auth.grantOfflineAccess({\n            // authuser: user.getAuthResponse().session_state.extraQueryParams.authuser\n            prompt: 'consent',\n        }).then(function(resp) {\n            console.log('grantOfflineAccess', resp);\n            var auth_code = resp.code;\n\n            // !!! Allow popup\n\n            // {code: \"4/AABatlLl3D2rnSW7vIMcgAaua0uvaZ4oEvy5c2Q_3_NJpEDOk25y6zN8Pr7eBB8rsZ6wv0PQP_Rz_7ZABEccn4k\"}\n        });\n    };\n\n    componentDidMount() {\n        // console.log(\"gapi\", window.gapi);\n        // https://developers.google.com/api-client-library/javascript/reference/referencedocs\n\n        // Here we use gapi.load('client:auth2', ...) to load both the client module (for dealing with API requests)\n        // and the auth2 module (for dealing with OAuth 2.0) upfront. The gapi.client.init fuction lazily loads auth2\n        // if it is needed. If you are sure your app needs auth, loading the two modules 'client:auth2' together\n        // before you call gapi.client.init will save one script load request.\n\n        // console.log(\"* gapi.load\");\n        window.gapi.load('client:auth2', this.initClient);\n    }\n\n    render() {\n        // console.log(\"render\", this.state);\n\n        const { isAuthorized, userProfile } = this.state;\n\n        return (\n            <Router>\n                <div>\n                    <div className=\"header\">\n                        Youtube Playlist Editor\n                        <button onClick={this.grantAccess}>Grant access</button>\n                        {isAuthorized ? (\n                            <div className=\"header-info\">\n                                Authorized for {userProfile.getName()}\n                            </div>\n                        ) : (\n                            <span>\n                                <button onClick={this.authorize}>\n                                    Authorize\n                                </button>\n                            </span>\n                        )}\n                        {isAuthorized && (\n                            <Link className=\"header-link\" to=\"/channels\">\n                                Channels\n                            </Link>\n                        )}\n                        {isAuthorized && (\n                            <Link className=\"header-link\" to=\"/playlists\">\n                                Playlists\n                            </Link>\n                        )}\n                        {isAuthorized && (\n                            <Link className=\"header-link\" to=\"/subscriptions\">\n                                Subscriptions\n                            </Link>\n                        )}\n                        {isAuthorized && (\n                            <Link className=\"header-link\" to=\"/videos2\">\n                                Videos\n                            </Link>\n                        )}\n                    </div>\n                    <div className=\"content\">\n                        {!isAuthorized && (\n                            <div>\n                                <p>\n                                    You need to authorize the application to\n                                    access your Youtube playlists.\n                                </p>\n                                <p>\n                                    Click the{' '}\n                                    <button onClick={this.authorize}>\n                                        Authorize\n                                    </button>{' '}\n                                    button to allow the access.\n                                </p>\n                            </div>\n                        )}\n                        <Switch>\n                            {/*<Route exact={true} path=\"/\" component={Home}/>*/}\n                            {/*<Route path=\"/playlists\" component={Playlists} />*/}\n                            <Route\n                                path=\"/channels\"\n                                render={props => (\n                                    <Channels\n                                        {...props}\n                                        isAuthorized={isAuthorized}\n                                    />\n                                )}\n                            />\n                            <Route\n                                path=\"/subscriptions\"\n                                render={props => (\n                                    <Subscriptions\n                                        {...props}\n                                        isAuthorized={isAuthorized}\n                                    />\n                                )}\n                            />\n                            <Route\n                                path=\"/playlists\"\n                                render={props => (\n                                    <Playlists\n                                        {...props}\n                                        isAuthorized={isAuthorized}\n                                    />\n                                )}\n                            />\n                            <Route\n                                path=\"/videos/:playlistid\"\n                                render={props => (\n                                    <Videos\n                                        {...props}\n                                        isAuthorized={isAuthorized}\n                                    />\n                                )}\n                            />\n                            <Route\n                                path=\"/videos2\"\n                                render={props => (\n                                    <TwinVideos\n                                        {...props}\n                                        isAuthorized={isAuthorized}\n                                    />\n                                )}\n                            />\n                        </Switch>\n                    </div>\n                </div>\n            </Router>\n        );\n    }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n        // [::1] is the IPv6 localhost address.\n        window.location.hostname === '[::1]' ||\n        // 127.0.0.1/8 is considered localhost for IPv4.\n        window.location.hostname.match(\n            /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n        )\n);\n\nexport default function register() {\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n            return;\n        }\n\n        window.addEventListener('load', () => {\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n            if (isLocalhost) {\n                // This is running on localhost. Lets check if a service worker still exists or not.\n                checkValidServiceWorker(swUrl);\n\n                // Add some additional logging to localhost, pointing developers to the\n                // service worker/PWA documentation.\n                navigator.serviceWorker.ready.then(() => {\n                    console.log(\n                        'This web app is being served cache-first by a service ' +\n                            'worker. To learn more, visit https://goo.gl/SC7cgQ'\n                    );\n                });\n            } else {\n                // Is not local host. Just register service worker\n                registerValidSW(swUrl);\n            }\n        });\n    }\n}\n\nfunction registerValidSW(swUrl) {\n    navigator.serviceWorker\n        .register(swUrl)\n        .then(registration => {\n            registration.onupdatefound = () => {\n                const installingWorker = registration.installing;\n                installingWorker.onstatechange = () => {\n                    if (installingWorker.state === 'installed') {\n                        if (navigator.serviceWorker.controller) {\n                            // At this point, the old content will have been purged and\n                            // the fresh content will have been added to the cache.\n                            // It's the perfect time to display a \"New content is\n                            // available; please refresh.\" message in your web app.\n                            console.log(\n                                'New content is available; please refresh.'\n                            );\n                        } else {\n                            // At this point, everything has been precached.\n                            // It's the perfect time to display a\n                            // \"Content is cached for offline use.\" message.\n                            console.log('Content is cached for offline use.');\n                        }\n                    }\n                };\n            };\n        })\n        .catch(error => {\n            console.error('Error during service worker registration:', error);\n        });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n    // Check if the service worker can be found. If it can't reload the page.\n    fetch(swUrl)\n        .then(response => {\n            // Ensure service worker exists, and that we really are getting a JS file.\n            if (\n                response.status === 404 ||\n                response.headers.get('content-type').indexOf('javascript') ===\n                    -1\n            ) {\n                // No service worker found. Probably a different app. Reload the page.\n                navigator.serviceWorker.ready.then(registration => {\n                    registration.unregister().then(() => {\n                        window.location.reload();\n                    });\n                });\n            } else {\n                // Service worker found. Proceed as normal.\n                registerValidSW(swUrl);\n            }\n        })\n        .catch(() => {\n            console.log(\n                'No internet connection found. App is running in offline mode.'\n            );\n        });\n}\n\nexport function unregister() {\n    if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready.then(registration => {\n            registration.unregister();\n        });\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nfunction noop() {}\nif (process.env.NODE_ENV !== 'development') {\n    console.log = noop;\n    console.warn = noop;\n    console.error = noop;\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}